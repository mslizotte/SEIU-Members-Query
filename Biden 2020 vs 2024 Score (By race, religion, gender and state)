echo "# SEIU-Members-Query" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin https://github.com/mslizotte/SEIU-Members-Query.git
git push -u origin main
select count(membership_reporting.current_membership.dwid) AS SEIU_Members, membership_reporting.current_membership.state, membership_reporting.current_membership.gender, membership_reporting.current_membership.catalist_race, membership_reporting.current_membership.division,
(case when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 70.0 then '2024 VCI High' when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 < 70.0 then '2024 VCI Mid' when catalist_periodic_install.models.catalistmodel_vch_index_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 0.01 then '2024 VCI Low' else '2024 VCI Unknown' end),
(case when membership_reporting.current_membership.catalist_age <= 24 then 'age under 25' when  membership_reporting.current_membership.catalist_age >= 25 and membership_reporting.current_membership.catalist_age <= 34 then 'age 25-34' when  membership_reporting.current_membership.catalist_age >= 35 and membership_reporting.current_membership.catalist_age <= 44 then 'age 35-44' when  membership_reporting.current_membership.catalist_age >= 45 and membership_reporting.current_membership.catalist_age <=54 then 'age 45-54' when  membership_reporting.current_membership.catalist_age >= 55 and membership_reporting.current_membership.catalist_age <= 64 then 'age 55-64' else 'age 65+' end), 
(case when catalist_periodic_install.models.catalistmodel_biden_support >= 70.0 then 'Biden 2020 High' when catalist_periodic_install.models.catalistmodel_biden_support >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support < 70.0 then 'Biden 2020 Mid' when catalist_periodic_install.models.catalistmodel_biden_support < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support >= 0.01 then 'Biden 2020 Low' else 'Biden 2020 unknown' end), 
(case when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 70.0 then 'Biden 2024 High' when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 < 70.0 then 'Biden 2024 Mid' when catalist_periodic_install.models.catalistmodel_biden_support_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 0.01 then 'Biden 2024 Low' else 'Biden 2024 unknown' end)
from membership_reporting.current_membership
Inner Join catalist_periodic_install.models ON catalist_periodic_install.models.dwid = membership_reporting.current_membership.dwid
AND catalist_periodic_install.models.state = membership_reporting.current_membership.state
Where membership_reporting.current_membership.member_type Not Like 'retire%'
Group by membership_reporting.current_membership.state, membership_reporting.current_membership.gender, membership_reporting.current_membership.catalist_race, membership_reporting.current_membership.division,
(case when membership_reporting.current_membership.catalist_age <= 24 then 'age under 25' when  membership_reporting.current_membership.catalist_age >= 25 and membership_reporting.current_membership.catalist_age <= 34 then 'age 25-34' when  membership_reporting.current_membership.catalist_age >= 35 and membership_reporting.current_membership.catalist_age <= 44 then 'age 35-44' when  membership_reporting.current_membership.catalist_age >= 45 and membership_reporting.current_membership.catalist_age <=54 then 'age 45-54' when  membership_reporting.current_membership.catalist_age >= 55 and membership_reporting.current_membership.catalist_age <= 64 then 'age 55-64' else 'age 65+' end),
(case when catalist_periodic_install.models.catalistmodel_biden_support >= 70.0 then 'Biden 2020 High' when catalist_periodic_install.models.catalistmodel_biden_support >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support < 70.0 then 'Biden 2020 Mid' when catalist_periodic_install.models.catalistmodel_biden_support < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support >= 0.01 then 'Biden 2020 Low' else 'Biden 2020 unknown' end), 
(case when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 70.0 then 'Biden 2024 High' when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 < 70.0 then 'Biden 2024 Mid' when catalist_periodic_install.models.catalistmodel_biden_support_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 0.01 then 'Biden 2024 Low' else 'Biden 2024 unknown' end)
