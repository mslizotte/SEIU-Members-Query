select count(catalist_periodic_install.models.dwid), catalist_periodic_install.models.state, 
(case when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 70.0 then '2024 VCI High' when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 < 70.0 then '2024 VCI Mid' when catalist_periodic_install.models.catalistmodel_vch_index_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 0.01 then '2024 VCI Low' else '2024 VCI Unknown' end), (case when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 70.0 then 'Biden 2024 High' when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 < 70.0 then 'Biden 2024 Mid' when catalist_periodic_install.models.catalistmodel_biden_support_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 0.01 then 'Biden 2024 Low' else 'Biden 2024 unknown' end), (case when catalist_periodic_install.models.catalistmodel_biden_support >= 70.0 then 'Biden 2020 High' when catalist_periodic_install.models.catalistmodel_biden_support >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support < 70.0 then 'Biden 2020 Mid' when catalist_periodic_install.models.catalistmodel_biden_support < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support >= 0.01 then 'Biden 2020 Low' else 'Biden 2020 unknown' end)
from catalist_periodic_install.models 
Group by catalist_periodic_install.models.state, 
(case when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 70.0 then '2024 VCI High' when catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 < 70.0 then '2024 VCI Mid' when catalist_periodic_install.models.catalistmodel_vch_index_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_vch_index_2024 >= 0.01 then '2024 VCI Low' else '2024 VCI Unknown' end), (case when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 70.0 then 'Biden 2024 High' when catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 < 70.0 then 'Biden 2024 Mid' when catalist_periodic_install.models.catalistmodel_biden_support_2024 < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support_2024 >= 0.01 then 'Biden 2024 Low' else 'Biden 2024 unknown' end), (case when catalist_periodic_install.models.catalistmodel_biden_support >= 70.0 then 'Biden 2020 High' when catalist_periodic_install.models.catalistmodel_biden_support >= 30.0 and catalist_periodic_install.models.catalistmodel_biden_support < 70.0 then 'Biden 2020 Mid' when catalist_periodic_install.models.catalistmodel_biden_support < 30.0 and catalist_periodic_install.models.catalistmodel_biden_support >= 0.01 then 'Biden 2020 Low' else 'Biden 2020 unknown' end)

